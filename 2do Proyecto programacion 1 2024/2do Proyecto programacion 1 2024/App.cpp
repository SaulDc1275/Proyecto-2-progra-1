#include "App.h"

App::App()
{
    
    MenuTexture.loadFromFile("Imagenes/Menu.png");
    Menu.setTexture(MenuTexture);
    CreateMenuButton();
    Window.create(sf::VideoMode(1380, 720), "Rutas Turísticas");
    MapTexture.loadFromFile("Imagenes/Mapa.png");
    Map.setTexture(MapTexture);
    font.loadFromFile("Fuentes/Retro_Gaming.ttf");
    CreateMapButtons();

}

void App::Start()
{
    DrawMenu();
    DrawMap();
}



void App::DrawMenu()
{
    Window.setFramerateLimit(60);
    while (Window.isOpen())
    {
        Event event;
        while (Window.pollEvent(event))
        {
            if (event.type == Event::Closed)
                Window.close();

            if (event.type == Event::MouseButtonPressed)
            {
                if (event.mouseButton.button == Mouse::Left)
                {
                    Vector2f mousePos = Window.mapPixelToCoords(Mouse::getPosition(Window));

                    if (StartButton.getGlobalBounds().contains(mousePos)) {
                       
                        return;
                    }
                }
            }
        }

       
        Window.clear(Color::Black);
        Window.draw(Menu);
        Window.draw(StartButton);
        Window.draw(StartButtonText);
        Window.display();
    }
}

void App::DrawMap()
{
    Window.setFramerateLimit(60);
    while (Window.isOpen())
    {
        Event event;
        while (Window.pollEvent(event))
        {
            if (event.type == Event::Closed)
                Window.close();

            if (event.type == Event::MouseButtonPressed) {
                if (event.mouseButton.button == Mouse::Left) {
                    Vector2f mousePos = Window.mapPixelToCoords(Mouse::getPosition(Window));


                    for (int i = 0; i < 6; i++) {
                        if (buttons[i].getGlobalBounds().contains(mousePos)) {
                            HandleButtonClick(i);
                        }
                    }
                }
            }
        }

        Window.clear();
        Window.draw(Map);
        for (int i = 0; i < 6; i++) {
            Window.draw(buttons[i]);
            Window.draw(buttonTexts[i]);
        }
        Window.display();
    }

}

void App::CreateMenuButton()
{
    
    float PositionX = ((1380 - 200) / 2);
    float PositionY = (((720 - 50) / 2) + 100);
    StartButton.setSize(Vector2f(220, 60));
    StartButton.setFillColor(Color::Color(61, 142, 152));
    StartButton.setPosition(PositionX, PositionY);


    StartButtonText.setFont(font);
    StartButtonText.setString("Iniciar");
    StartButtonText.setCharacterSize(49);
    StartButtonText.setFillColor(Color::White);
    StartButtonText.setPosition(PositionX+5,PositionY);
}

void App::CreateMapButtons()
{
    float PossitionX = 1130.0;
    float PossitionY = 80.0;
    Color color(61, 142, 152);
    for (int i = 0; i < 6; i++) {
        buttons[i].setSize(Vector2f(220, 60));
        buttons[i].setPosition(PossitionX, PossitionY);
        buttons[i].setFillColor(color);
        PossitionY += 100;
    }

    buttonTexts[0].setString("Crear una nueva ruta");
    buttonTexts[0].setCharacterSize(16);
    buttonTexts[1].setString("Seleccionar color");
    buttonTexts[1].setCharacterSize(18);
    buttonTexts[2].setString("Guardar ruta");
    buttonTexts[2].setCharacterSize(23);
    buttonTexts[3].setString("Cargar rutas");
    buttonTexts[3].setCharacterSize(23);
    buttonTexts[4].setString("Editar rutas");
    buttonTexts[4].setCharacterSize(23);
    buttonTexts[5].setString("Salir");
    buttonTexts[5].setCharacterSize(25);

    for (int i = 0; i < 6; i++) {
        buttonTexts[i].setFont(font);
        buttonTexts[i].setFillColor(Color::White);
        FloatRect textBounds = buttonTexts[i].getLocalBounds();
        buttonTexts[i].setOrigin(textBounds.left + textBounds.width / 2.0f, textBounds.top + textBounds.height / 2.0f);
        buttonTexts[i].setPosition(buttons[i].getPosition().x + buttons[i].getSize().x / 2.0f, buttons[i].getPosition().y + buttons[i].getSize().y / 2.0f);
    }
    
}


void App::HandleButtonClick(int buttonNumber) {
    switch (buttonNumber                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ) {
    case 0:
        printf("Crear una nueva ruta clicado\n");
        break;
    case 1:
        printf("Seleccionar color clicado\n");
        break;
    case 2:
        printf("Guardar ruta clicado\n");
        break;
    case 3:
        printf("Cargar rutas clicado\n");
        break;
    case 4:
        printf("Editar rutas clicado\n");
        break;
    case 5:
        printf("Salir clicado\n");
        Window.close();
        break;
    default:
        break;
    }
}
